{% extends 'base.html' %}
{% load static %}

{% block title %}
    : Audio Music
{% endblock title %}

{% block script %}
<script>
    window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        // eligible speech
        const recognition = new SpeechRecognition();
        recognition.interimResults = true;

        
        document.addEventListener("DOMContentLoaded", function() {
            isActive = false;
            instruction = false;
            isPlayingtheMusic = false;
            playingMusic = false;
            // isBot = false;
        });   

        recognition.lang = 'en-US';
        function speak(text) {
            const msg = new SpeechSynthesisUtterance(text);

            msg.rate = 1;
            msg.volume = 1;
            msg.pitch = 1;

            window.speechSynthesis.speak(msg);
        };
        
        console.log('This is the Status Before: ', localStorage.getItem('status'));
        console.log('This is the Mode Before: ', localStorage.getItem('mode'));

        if (!localStorage.getItem('status')) {
    // If not, set a pre-determined default value
            localStorage.setItem('mode', 'English'); 
            localStorage.setItem('status', true);
        };


        var csrfToken = getCookie('csrftoken');
        console.log('This is the Token:', csrfToken);
        var currentUrl = window.location.href;

        let buttonStatus = document.getElementById('buttonStatus');
        let contentMode = document.getElementById('content');

       // displays current language mode dynamically
        if (localStorage.getItem('mode') == 'Filipino') {
            contentMode.textContent = localStorage.getItem('mode');
        } else {
            contentMode.textContent = localStorage.getItem('mode');
        }

        // TRUE for ENGLISH && FALSE for FILIPINO
        // Trigger for LocalStorage and for Dynamic values
        buttonStatus.addEventListener('click', function () {
            let status = localStorage.getItem('status');
           
           console.log('Hello')

           if (status === 'true') {
               localStorage.setItem('mode', 'Filipino'); 
               contentMode.textContent = localStorage.getItem('mode');
               localStorage.setItem('status', false);
           } else {
               localStorage.setItem('mode', 'English'); 
               contentMode.textContent = localStorage.getItem('mode');
               localStorage.setItem('status', true);
           }
           

           console.log('This is the Status After: ', localStorage.getItem('status'));
           console.log('This the language mode:', localStorage.getItem('mode'))
        });

        let player;
         // RETRIEVING SAVED DATA TO DISPLAY --> Music
         if (localStorage.getItem('musicId') !== null && JSON.parse(localStorage.getItem('isPlayingMusic'))) {
            // 2. This code loads the IFrame Player API code asynchronously.
        var tag = document.createElement('script');
          
          tag.src = "https://www.youtube.com/iframe_api";
          var firstScriptTag = document.getElementsByTagName('script')[0];
          firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

          // 3. This function creates an <iframe> (and YouTube player)
          //    after the API code downloads.

        
          function onYouTubeIframeAPIReady() {
            var savedMusicId = localStorage.getItem('musicId');
            if (savedMusicId) {
                
                player = new YT.Player('player', {
                height: '390',
                width: '640',
                videoId: savedMusicId,
                playerVars: {
                    'playsinline': 1,
                    'autoplay': 1,
                    'origin': "https://www.youtube.com",
                },
                events: {
                    'onReady': onPlayerReady,
                    // 'onStateChange': onPlayerStateChange
                }
                });  
                // localStorage.setItem('iplayer', JSON.stringify(player))
                // console.log()
            } 
            isPlayingtheMusic = true;
            playingMusic = true;   
          }

          // 4. The API will call this function when the video player is ready.
          function onPlayerReady(event) {
            event.target.playVideo();
          }
          // 5. The API calls this function when the player's state changes.
          //    The function indicates that when playing a video (state=1),
          //    the player should play for six seconds and then stop.
          // var done = false;
          // function onPlayerStateChange(event) {
          //   if (event.data == YT.PlayerState.PLAYING && !done) {
          //     setTimeout(stopVideo, 6000);
          //     done = true;
          //   }
          // }
          function changeVideo(videoId) {
            
            if (player) {
            player.loadVideoById(videoId);
            } else {
            console.error('Player not initialized!');
            }
        }
          function stopVideo() {
            
            player.stopVideo();
          }

          function pauseVideo() {
             
             console.log(player.pauseVideo())
            if (player.pauseVideo) {
              player.pauseVideo();
            } 
          }

          function playVideo() {
            // player = JSON.parse(localStorage.getItem('iplayer'))
            console.log(player.playVideo)
            if (player.playVideo) {
              player.playVideo();
            
            } 
          }
        } else {
            document.querySelector('#audiobook-gif').style.display = 'block';
        };

        // CSRF TOKEN 
        function getCookie(name) {
                var cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        var cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                console.log('This is inside 2nd Cookie:', cookieValue)
                return cookieValue;
            };

        // Speaking Details Command
        function details() {

            // if (JSON.parse(localStorage.getItem('isPlayingMusic'))) {
            //         console.log('Music Player Cannot be interrupted when Playing.');
            //         {};
            // } else { 
            const speakDetails = document.querySelectorAll('p');
            let theDetails = []

            speakDetails.forEach(function(par, idx){
                let parContent = par.textContent;
                theDetails.push(parContent);
            });
            
            fetch("{% url 'index' %}", {
                   method: 'POST',
                   headers: {
                       'Content-Type': 'application/json',
                       'X-CSRFToken': csrfToken,
                   },
                   body: JSON.stringify({
                    //    details: allPdetails,
                       details: theDetails,
                       status: JSON.parse(localStorage.getItem('status')),
                   }),
               })
               .then(response => response.json())
               .then(data => {
                   console.log('Success', data);
               })
               .catch((error) => {
                   console.error('Error', error);
               });
            }
        // };

        // // <--- Request Details by Clicking --->
        //     let mainElement = document.querySelector('main');


        //     mainElement.onclick = function () {
            
        //         if (JSON.parse(localStorage.getItem('isPlayingMusic'))) {
        //             console.log('Music Player Cannot be interrupted when Playing.');
        //             {};
        //         } else {
                    
        //             const Pdetails = document.querySelectorAll('p');
        //             let allPdetails = [];

        //             if (localStorage.getItem('mode') == 'Filipino') {
        //             allPdetails.push('Hanapin ang musikang gusto mong pakinggan sa pamamagitan ng paggamit at pagsasabi ng "search" na keyword.')
        //             } else{
        //                 Pdetails.forEach(function(paragraph, index) {
        //                     var paragraphContent = paragraph.textContent;
        //                     allPdetails.push(paragraphContent);  
        //                 });
        //             };
                        
        //                 console.log(allPdetails)
                        
        //                 fetch("{% url 'audio_music' %}", {
        //                     method: 'POST',
        //                     headers: {
        //                         'Content-Type': 'application/json',
        //                         'X-CSRFToken': csrfToken,
        //                     },
        //                     body: JSON.stringify({
        //                         details: allPdetails,
        //                         status: JSON.parse(localStorage.getItem('status')),
        //                     }),
        //                 })
        //                 .then(response => response.json())
        //                 .then(data => {
        //                         count_click = 0
                            
        //                     console.log('Success', data);
        //                 })
        //                 .catch((error) => {
        //                     console.error('Error', error);
        //                 });
        //         }
        //     }; // End of Main.click ()

        // START YOUTUBE API IFRAME MUSIC
        // 2. This code loads the IFrame Player API code asynchronously.
        var tag = document.createElement('script');
          
          tag.src = "https://www.youtube.com/iframe_api";
          var firstScriptTag = document.getElementsByTagName('script')[0];
          firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

          // 3. This function creates an <iframe> (and YouTube player)
          //    after the API code downloads.

        
          function onYouTubeIframeAPIReady() {
            var savedVideoId = localStorage.getItem('musicId');
            if (savedVideoId) {
                
                player = new YT.Player('player', {
                height: '390',
                width: '640',
                videoId: savedVideoId,
                playerVars: {
                    'playsinline': 1,
                    'autoplay': 1,
                    'origin': "https://www.youtube.com",
                },
                events: {
                    'onReady': onPlayerReady,
                    // 'onStateChange': onPlayerStateChange
                }
                });  
                // localStorage.setItem('iplayer', JSON.stringify(player))
                // console.log()
            } 
          }

          // 4. The API will call this function when the video player is ready.
          function onPlayerReady(event) {
            event.target.playVideo();
          }
          // 5. The API calls this function when the player's state changes.
          //    The function indicates that when playing a video (state=1),
          //    the player should play for six seconds and then stop.
          // var done = false;
          // function onPlayerStateChange(event) {
          //   if (event.data == YT.PlayerState.PLAYING && !done) {
          //     setTimeout(stopVideo, 6000);
          //     done = true;
          //   }
          // }
          function changeVideo(videoId) {
            
            if (player) {
            player.loadVideoById(videoId);
            } else {
            console.error('Player not initialized!');
            }
        }
          function stopVideo() {
            
            player.stopVideo();
          }

          function pauseVideo() {
             
             console.log(player.pauseVideo())
            if (player.pauseVideo) {
              player.pauseVideo();
            } 
          }

          function playVideo() {
            // player = JSON.parse(localStorage.getItem('iplayer'))
            console.log(player.playVideo)
            if (player.playVideo) {
              player.playVideo();
            
            } 
          }
        let isActive;
        let instruction;
        let isPlayingtheMusic;
        let playingMusic;
       
       const texts = document.querySelector('#texts')
       let p = document.createElement('p')
    
        // <--- THIS IS FOR NAVIGATION AND SPEAKING LOCATION PAGE --->
        window.addEventListener('load', () => {
           
            recognition.addEventListener('result', (e) => {
            const text = Array.from(e.results)
            .map(result => result[0])
            .map(result => result.transcript)
            .join('');

            console.log(text);
            
            // Navigation -> Thru Voice 
            if(e.results[0].isFinal) {

                if (text === 'ally') {
                    if (isPlayingtheMusic) {
                        pauseVideo();
                        isPlayingtheMusic = false;
                    };
                     console.log('Activated, what can I do for you?');
                    if (localStorage.getItem('mode') == 'English') {
                        var audio = new Audio("{% static 'audio/activation.mp3' %}");
                    } else {
                        var audio = new Audio("{% static 'audio/fil_activation.mp3' %}");
                    };
                    audio.play();
                    // localStorage.setItem('isPlayingMusic', false);
                    // pauseVideo();
                    isActive = true;
                };

                if (playingMusic || isActive) {
                    if (text == 'stop') {
                        pauseVideo();
                        isPlayingtheMusic = false;

                    } else if (text == 'play') {
                        playVideo();
                        isPlayingtheMusic = true;

                    };
                    
                };


                if (isActive) {
                    let availableCommands = ['ally', 'stop', 'play', 'search', 'refresh', 'details', 'home', 'guidelines', 'audiobook', 'music', 'assistant', 'time', 'location', 'news', 'motivation', 'technology']
                // <--- Feature Request --->
                // <--- Feature search --->
                if (text.startsWith('search')) {
                    let output = text.replace(/^search\s*/, "")
                    // console.log('Cakes & Eclairs YT '+output)
                    // Define the endpoint URL
const url = "https://www.googleapis.com/youtube/v3/search";
// const url = "https://www.googleapis.com/youtube/v3/videos";
console.log(output + ' lyrics')
// Define query parameters
const params = {
    part: "snippet",
    q: output + ' song',  // Replace with your search query
    type: "video",
    videoEmbeddable: true,
    videoLicense: "creativeCommon", //
    maxResults: 1,  // Limit to 1 result
    key: "AIzaSyDgdZIe2Xs8ycbTzbhJZiDPP1ZstHcktu0"  // Replace with your YouTube Data API key
};

// Construct URL with query parameters
const queryString = new URLSearchParams(params).toString();
const fullUrl = `${url}?${queryString}`;

// Send GET request to the API
fetch(fullUrl)
    .then(response => {
        if (!response.ok) {
            throw new Error("Network response was not ok");
        }
        return response.json();
    })
    .then(data => {
        console.log('DATA', data)
        // Extract video details from response
        if (data.items && data.items.length > 0) {
            const musicId = data.items[0].id.videoId;
            const musicTitle = data.items[0].snippet.title;
            // const embeddable = data.items[0].status.embeddable;
           

            // if (!embeddable) {
            //     console.log("Video is not embeddable.");
            //     // Display a message or take appropriate action
            // }

            
            console.log("Music ID:", musicId);
            console.log("Music Title:", musicTitle);
            

            let videoContainer = document.querySelector('#player');
            //width="560" height="315"
            
            // MUSIC YOUTUBE IFRAME API
            
           
            if (localStorage.getItem('musicId') != null) {
               changeVideo(musicId);
               localStorage.setItem('musicId', musicId);
               localStorage.setItem('musicTitle', musicTitle);
           } else {
               localStorage.setItem('musicId', musicId);
               localStorage.setItem('musicTitle', musicTitle);
               onYouTubeIframeAPIReady();
               
           }

          
            // NOTIFYING AND SPEAKING PURPOSES CODE
            fetch("{% url 'audio_music' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'Request for music Provided.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });

           
            localStorage.setItem('isPlayingMusic', true);
            // var videoFrame = document.getElementById('videoFrame');
            isPlayingtheMusic = true;
            playingMusic = true;   

        } else {
            console.log("No music found.");
        }
    })
    .catch(error => {
        console.error("Error:", error);
    });

                isActive = false;
                    
                } // End of request Feature Block

                // if (text === 'restart') {
                //     fetch("{% url 'newsfeed' %}", {
                //         method: 'POST',
                //         headers: {
                //             'Content-Type': 'application/json',
                //             'X-CSRFToken': csrfToken,
                            
                //         },
                //         body: JSON.stringify({
                //             details: 'restart',
                //             status: JSON.parse(localStorage.getItem('status')),
                //         }),
                //         })
                //         .then(response => response.json())
                //         .then(data => {
                //             console.log('Success', data);
                //         })
                //         .catch((error) => {
                //             console.error('Error', error);
                //         });
                // };

                else if (text === 'details') {
                    details();
                    isActive = false;
                }

                else if (text === 'stop') {
                    localStorage.setItem('isPlayingMusic', false);
                    pauseVideo();
                    isActive = false;
                
                } // End for STOP keyword

                else if (text === 'play') {
                    localStorage.setItem('isPlayingMusic', true);
                    playVideo();
                    isPlayingtheMusic = false;
                    isActive = false;

                    if (localStorage.getItem('musicId') === null) {
                            fetch("{% url 'audio_music' %}", {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': csrfToken,
                                
                            },
                            body: JSON.stringify({
                                details: 'sorry, you have not requested a Music yet.',
                                status: JSON.parse(localStorage.getItem('status')),
                            }),
                        })
                        .then(response => response.json())
                        .then(data => {
                            console.log('Success', data);
                        })
                        .catch((error) => {
                            console.error('Error', error);
                        });
                    };
                    isActive = false;
                } // End for CONTINUTE keyword

                else if (text === 'refresh') {
                    // Reload the current page
                    location.reload();
                    isActive = false;
                }


                else if (text.startsWith('set') && text.includes('english')){
                    if (localStorage.getItem('mode') == 'English') {
                        fetch("{% url 'set_language' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'language already set in English mode.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                        // speak('language already set in English mode.');
                    } else {
                        // speak('setting language to english mode.')
                        fetch("{% url 'set_language' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,    
                        },
                        body: JSON.stringify({
                            details: 'setting language to English mode.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                        localStorage.setItem('mode', 'English'); 
                        contentMode.textContent = localStorage.getItem('mode');
                        localStorage.setItem('status', true);    
                    }
                    isActive = false;
                } else if (text.startsWith('set') && text.includes('filipino')) {
                    if (localStorage.getItem('mode') == 'Filipino') {
                        // speak('language already set in Filipino mode.');
                        fetch("{% url 'set_language' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'language already set in Filipino mode.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                    } else {
                        // speak('setting language to filipino mode.');
                        fetch("{% url 'set_language' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'setting language to filipino mode.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                        localStorage.setItem('mode', 'Filipino'); 
                        contentMode.textContent = localStorage.getItem('mode');
                        localStorage.setItem('status', false);
                    }
                    isActive = false;
                }

                // Starts here Keyword Voice Navigation
                else if (text === 'home') {
                    window.location.href = "{% url 'index' %}"
                    fetch("{% url 'index' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'You are going to Home page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                    
                }
                else if (text === 'guidelines') {
                    window.location.href = "{% url 'guidelines' %}"
                    fetch("{% url 'guidelines' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'Going to user guidelines page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                }
                // Audio Apps
                else if (text === 'audiobook') {
                    window.location.href = "{% url 'audio_book' %}"
                    fetch("{% url 'audio_book' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'You are going to audio book page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                }
                else if (text === 'music') {
                    window.location.href = "{% url 'audio_music' %}"
                    fetch("{% url 'audio_music' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'You are already in  music page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                }
                // Info Apps
                else if (text === 'assistant') {
                    window.location.href = "{% url 'assistantbot' %}"
                    // speak('you are going to assistant bot page.')
                    fetch("{% url 'assistantbot' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                        },
                        body: JSON.stringify({
                            details: 'You are going to assistant page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                }
                else if (text === 'time') {
                    window.location.href = "{% url 'current_time_date' %}"
                    fetch("{% url 'current_time_date' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'You are going to date and time page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                    
                }
                else if (text === 'location') {
                    window.location.href = "{% url 'location' %}"
                    fetch("{% url 'location' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'You are going to location page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });     
                }
                else if (text === 'news'){
                    window.location.href = "{% url 'newsfeed' %}"
                    fetch("{% url 'newsfeed' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                            
                        },
                        body: JSON.stringify({
                            details: 'You are going to news page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                }
                else if (text === 'motivation') {
                    window.location.href = "{% url 'motivation' %}"
                    // speak('you are going to motivation page')
                    fetch("{% url 'motivation' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                        },
                        body: JSON.stringify({
                            details: 'you are going to motivation page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                }
                else if (text === 'technology') {
                    window.location.href = "{% url 'technologies' %}"
                    // speak('You are going to technology page.')
                    fetch("{% url 'technologies' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrfToken,
                        },
                        body: JSON.stringify({
                            details: 'you are going to technology page.',
                            status: JSON.parse(localStorage.getItem('status')),
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Success', data);
                    })
                    .catch((error) => {
                        console.error('Error', error);
                    });
                } else if (!availableCommands.includes(text)) {
                    console.log('command not recognized')
                    if (localStorage.getItem('mode') == 'English') {
                        var audio = new Audio("{% static 'audio/notrecognized.mp3' %}");
                    } else {
                        var audio = new Audio("{% static 'audio/fil_notrecognized.mp3' %}");
                    };
                    audio.play();
                    isActive = false;
                }
            } // if isActive
            };
        });


        recognition.addEventListener('end', (e) => {
           recognition.start(); 
        });

        recognition.start();
    });
    
   
</script>
{% endblock script %}

{% block content %}
<div class="container-lg">
    <div class="row min-vh-100 d-flex flex-column justify-content-center align-items-center ">

        <div class="col-lg-6 align-self-lg-center text-center mt-2" data-aos="fade-right">
            <h1 class="fw-bolder text-center text-white-50"><i class="bi bi-boombox"></i> <span style="color:  #ADD8E6;">Audio Music</span></h1>
        </div>
       
        <div class="container">
            <div class="row">
                <div class="col text-center" id="texts">
                    <!-- This is where p tags are inserted -->
                    

                    <div class="container" id="book-determined">
                        <div class="row">
                            <div class="col-lg-6 align-self-lg-center align-self-end py-5" data-aos="fade-right">
                                <h3 class="fw-bolder text-center" style="color: #ADD8E6">"Harmonies Heard: Accessible Music for the Visually Impaired"</h3>
                                <div class="rounded-5">
                                    <p class="text-white-50">Find the music you wanted to listen by utilizing and saying the "search" keyword.</p>
                                </div>
                            </div>
                            <div class="col-lg-6 d-flex flex-column align-items-center py-md-0 py-5 embed-responsive embed-responsive-16by9" data-aos="fade-right" id="player">

                                <img id="audiobook-gif" src="{% static 'assets/audiomusic.jpg' %}" width="400" class="img-fluid rounded-5">
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>
{% endblock content %}