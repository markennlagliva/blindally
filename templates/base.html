{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:description" content="Blind Ally: An assistive web application Technology for visually impaired people.">
    <meta property="og:title" content="BlindAlly">
    <!-- <meta property="og:image" content="{% static 'assets' %}">  -->
 

    <title>BlindAlly {% block title %} {% endblock %}</title>

    <link rel="shortcut icon" href="{% static 'assets/icon.jpg' %}" type="image/x-icon" />
    <link rel="apple-touch-icon" href="{% static 'assets/icon.jpg' %}" />

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">

    <!-- AOS CSS -->
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

    <!-- Loader -->
    <link rel="stylesheet" href="{% static 'loader.css' %}">
    <script src="{% static 'loader.js' %}"></script>
    
</head>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500&display=swap');
    * {
        font-family: 'Poppins', sans-serif;
        color: white;
    }
</style>
{% block style %}
<style>

    #home {
        background-image: url("{% static 'assets/home.png' %}"); 
        background-repeat: no-repeat;
        background-size: cover; 
        background-position: center center; 
    }

    @media screen and (max-width: 280px) {
        .navbar-brand img {
            width: 100px;
        }
    }
    
    #nav-bg {
        backdrop-filter: blur(50px);
        
    }

</style>
{% endblock style %}
<style>
    .dropdown-item:hover, .nav-item .nav-link:hover, #mode button:hover {
      background-color: #ffffff2d; /* Set your desired dropdown hover background color */
      /* Set your desired dropdown hover text color */
      transform: scale(1.1px);
      transition: 0.5s;
      
    }

    #mode {
      
      position: fixed;
      bottom: 20px;
      right: 20px;
    }

</style>
<body>
    <div class="loader"></div>

    <nav class="navbar navbar-expand-lg fixed-top rounder" id="nav-bg">
        <div class="container-lg">
            <a class="navbar-brand" href="#">
                <img src="{% static 'assets/logo-transparent.png' %}"  width="150" alt="logo">
            </a>
    

            <button class="navbar-toggler text-white border" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                 <i class="bi bi-list-stars"></i> <span class="text-white-50">Menu</span>
            </button>

          <div class="collapse navbar-collapse text-center text-white" id="navbarNav">
                <ul class="navbar-nav ms-auto gap-lg-3 gap-1">
                    <li class="nav-item border rounded-5">
                        <a class="nav-link rounded-5 text-white-50" aria-current="page" href="{% url 'index' %}"><i class="bi bi-house"></i> Home</a>
                    </li>
                    <li class="nav-item border rounded-5">
                        <a class="nav-link rounded-5 text-white-50" href="{% url 'guidelines' %}"><i class="bi bi-people"></i> User Guidelines</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white-50 border rounded-5" id="audioDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="bi bi-volume-up"></i> Audio apps <i class="bi bi-chevron-down"></i></a>
                        <div class="dropdown-menu border text-white-50 bg-transparent bg-gradient" aria-labelledby="audioDropdown">
                            <a class="dropdown-item border rounded-5 text-white-50" href="{% url 'audio_book' %}"><i class="bi bi-journal-album"></i> Audio Book</a>
                            <a class="dropdown-item border rounded-5 text-white-50 my-2" href="{% url 'audio_music' %}"><i class="bi bi-file-music"></i> Music</a>
                
                            <!-- <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">More Services</a>     -->
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white-50 border rounded-5" id="infoDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="bi bi-info-circle"></i> Info apps <i class="bi bi-chevron-down"></i></a>
                        <div class="dropdown-menu border text-white-50 bg-transparent bg-gradient" aria-labelledby="infoDropdown">
                            <a class="dropdown-item border rounded-5 text-white-50" href="{% url 'assistantbot' %}"><i class="bi bi-alexa"></i> Assistant</a>
                            <a class="dropdown-item border rounded-5 text-white-50 my-2" href="{% url 'current_time_date' %}"><i class="bi bi-calendar-check"></i> Current Date and Time</a>
                            <a class="dropdown-item border rounded-5 text-white-50" href="{% url 'location' %}"><i class="bi bi-geo-alt"></i> Current Location</a>
                            <a class="dropdown-item border rounded-5 text-white-50 my-2" href="{% url 'newsfeed' %}"><i class="bi bi-newspaper"></i> News Feed</a>
                            <!-- <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">More Services</a>     -->
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white-50 border rounded-5" id="moreDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="bi bi-three-dots"></i> More <i class="bi bi-chevron-down"></i></a>
                        <div class="dropdown-menu border text-white-50 bg-transparent bg-gradient" aria-labelledby="moreDropdown">
                            <a class="dropdown-item border rounded-5 text-white-50" href="{% url 'motivation' %}"><i class="bi bi-ev-front"></i> Motivation</a>
                            <a class="dropdown-item border rounded-5 text-white-50 my-2" href="{% url 'technologies' %}"><i class="bi bi-gear"></i> Technologies</a>
                
                            <!-- <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">More Services</a>     -->
                        </div>
                    </li> 

                </ul>
          </div>
          
        </div>
      </nav>

    <main>
      
        <section id="home" class="py-lg-0 py-5">
            {% block content %}
            <div class="container-lg py-lg-0 pt-sm-5 mt-sm-0 mt-5">
                <div class="row min-vh-100 d-flex justify-content-center align-items-center gap-lg-0 gap-3">
                    <div class="col-lg-6 d-flex flex-column justify-content-center " data-aos="fade-right">
                        <p class="d-lg-none d-block text-center text-white-50">Even without <span style="color: #CD86C9">Sight</span>, there is still a <span style="color: #CD86C9">Vision</span></p>
                        <img class="img-fluid align-self-center " src="{% static 'assets/blindally-hero.png' %}" width="400" alt="visually-impaired-image-hero-section">
                    </div>
                    <div class="col-lg-6 align-self-lg-center align-self-start" data-aos="fade-right">
                        <h1 class="text-center text-lg-start fw-bolder " style="color: #CD86C9">Blind Ally</h1>
                        <p class="text-white-50 text-center text-lg-start">"Fostering Digital Equity: A Holistic Exploration of Creating an Inclusive Online Experience for the <span style="color: #CD86C9">Visually Impaired Community</span>."</p>
                    </div>

                </div>
            </div>
            {% endblock content %}
        </section>
       
    </main>
   
    <footer>
        <div id="mode">              
            <button id="buttonStatus" class="btn btn-sm border rounded-5"><i><i class="bi bi-translate"></i> <span id="content">English</span></i></button>
        </div>
    </footer>
</body>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script>
        let mainElement = document.querySelector('main');
        window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        // eligible speech
        const recognition = new SpeechRecognition();
        recognition.interimResults = true;

        recognition.lang = 'en-US';
        function speak(text) {
            const msg = new SpeechSynthesisUtterance(text);

            msg.rate = 1;
            msg.volume = 1;
            msg.pitch = 1;

            window.speechSynthesis.speak(msg);
        };
        
        console.log('This is the Status Before: ', localStorage.getItem('status'));
        console.log('This is the Mode Before: ', localStorage.getItem('mode'));

        if (!localStorage.getItem('status')) {
    // If not, set a pre-determined default value
            localStorage.setItem('mode', 'English'); 
            localStorage.setItem('status', true);
        };


        var csrfToken = getCookie('csrftoken');
        console.log('This is the Token:', csrfToken);
        var currentUrl = window.location.href;

        let buttonStatus = document.getElementById('buttonStatus');
        let contentMode = document.getElementById('content');

       // displays current language mode dynamically
        if (localStorage.getItem('mode') == 'Filipino') {
            contentMode.textContent = localStorage.getItem('mode');
        } else {
            contentMode.textContent = localStorage.getItem('mode');
        }

        // TRUE for ENGLISH && FALSE for FILIPINO
        // Trigger for LocalStorage and for Dynamic values
        buttonStatus.addEventListener('click', function () {
            let status = localStorage.getItem('status');
           
           console.log('Hello')

           if (status === 'true') {
               localStorage.setItem('mode', 'Filipino'); 
               contentMode.textContent = localStorage.getItem('mode');
               localStorage.setItem('status', false);
           } else {
               localStorage.setItem('mode', 'English'); 
               contentMode.textContent = localStorage.getItem('mode');
               localStorage.setItem('status', true);
           }
           

           console.log('This is the Status After: ', localStorage.getItem('status'));
           console.log('This the language mode:', localStorage.getItem('mode'))
        });

        // CSRF TOKEN 
        function getCookie(name) {
                var cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        var cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                console.log('This is inside 2nd Cookie:', cookieValue)
                return cookieValue;
            };

        // Request Details by Clicking
        mainElement.onclick = function () {
           
            const Pdetails = document.querySelectorAll('p');
            let allPdetails = [];
            // console.log(Pdetails.length)

           
                Pdetails.forEach(function(paragraph, index) {
                    var paragraphContent = paragraph.textContent;
                    allPdetails.push(paragraphContent);
                });
                
            if ("{{request.path}}" === '/') {
                fetch("{% url 'index' %}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken,
                    },
                    body: JSON.stringify({
                        key: 'tap-detail-home',
                        details: allPdetails,
                        status: JSON.parse(localStorage.getItem('status')),
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success', data);
                })
                .catch((error) => {
                    console.error('Error', error);
                });   
            } else if ("{{request.path}}" === '/motivation') {
                fetch("{% url 'motivation' %}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken,
                    },
                    body: JSON.stringify({
                        key: 'tap-more-motivation',
                        details: allPdetails,
                        status: JSON.parse(localStorage.getItem('status')),
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success', data);
                })
                .catch((error) => {
                    console.error('Error', error);
                });
            } else if ("{{request.path}}" === '/technologies') {
                fetch("{% url 'technologies' %}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken,
                    },
                    body: JSON.stringify({
                        key: 'tap-more-technologies',
                        details: allPdetails,
                        status: JSON.parse(localStorage.getItem('status')),
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success', data);
                })
                .catch((error) => {
                    console.error('Error', error);
                });
            }
               
        };
        

        // THIS IS FOR NAVIGATION AND SPEAKING LOCATION PAGE
        window.addEventListener('load', () => {
           
            recognition.addEventListener('result', (e) => {
            const text = Array.from(e.results)
            .map(result => result[0])
            .map(result => result.transcript)
            .join('');

            console.log(text);
            
            // Navigation -> Thru Voice 
            if(e.results[0].isFinal) {
                if (text === 'home') {
                    window.location.href = "{% url 'index' %}"
                    speak('you are going to home page.')
                    
                }
                else if (text === 'guidelines') {
                    window.location.href = "{% url 'guidelines' %}"
                    speak('you are going to user-guidelines page.')
                }
                // Audio Apps
                else if (text === 'audiobook') {
                    window.location.href = "{% url 'audio_book' %}"
                    speak('you are goint to audio book page.')
                }
                else if (text === 'music') {
                    window.location.href = "{% url 'audio_music' %}"
                    speak('you are going to music page.')
                }
                // Info Apps
                else if (text === 'assistant') {
                    window.location.href = "{% url 'assistantbot' %}"
                    speak('you are going to assistant bot page.')
                }
                else if (text === 'time') {
                    window.location.href = "{% url 'current_time_date' %}"
                    speak('you are going to date and time page.')
                    
                }
                else if (text === 'location') {
                    window.location.href = "{% url 'location' %}"
                    speak('you are going to location page.')      
                }
                else if (text === 'news'){
                    window.location.href = "{% url 'newsfeed' %}"
                    speak('you are going to newsfeed page.')
                    // fetch("{% url 'index' %}", {
                    //     method: 'POST',
                    //     headers: {
                    //         'Content-Type': 'application/json',
                    //         'X-CSRFToken': csrfToken,
                            
                    //     },
                    //     body: JSON.stringify({
                    //         key: 'home',
                    //         status: JSON.parse(localStorage.getItem('status')),
                    //     }),
                    // })
                    // .then(response => response.json())
                    // .then(data => {
                    //     console.log('Success', data);
                    // })
                    // .catch((error) => {
                    //     console.error('Error', error);
                    // });
                }
                else if (text === 'motivation') {
                    window.location.href = "{% url 'motivation' %}"
                    speak('you are going to motivation page')
                    // fetch("{% url 'motivation' %}", {
                    //     method: 'POST',
                    //     headers: {
                    //         'Content-Type': 'application/json',
                    //         'X-CSRFToken': csrfToken,
                    //     },
                    //     body: JSON.stringify({
                    //         key: 'motivation',
                    //         status: JSON.parse(localStorage.getItem('status')),
                    //     }),
                    // })
                    // .then(response => response.json())
                    // .then(data => {
                    //     console.log('Success', data);
                    // })
                    // .catch((error) => {
                    //     console.error('Error', error);
                    // });
                }
                else if (text === 'technology') {
                    window.location.href = "{% url 'technologies' %}"
                    speak('You are going to technology page.')
                    // fetch("{% url 'technologies' %}", {
                    //     method: 'POST',
                    //     headers: {
                    //         'Content-Type': 'application/json',
                    //         'X-CSRFToken': csrfToken,
                    //     },
                    //     body: JSON.stringify({
                    //         key: 'technology',
                    //         status: JSON.parse(localStorage.getItem('status')),
                    //     }),
                    // })
                    // .then(response => response.json())
                    // .then(data => {
                    //     console.log('Success', data);
                    // })
                    // .catch((error) => {
                    //     console.error('Error', error);
                    // });
                }

                else if (text.startsWith('set') && text.includes('english')){
                    if (localStorage.getItem('mode') == 'English') {
                        speak('language already set in English mode.');
                    } else {
                        speak('setting language to english mode.')
                        localStorage.setItem('mode', 'English'); 
                        contentMode.textContent = localStorage.getItem('mode');
                        localStorage.setItem('status', true);    
                    }
                }
                else if (text.startsWith('set') && text.includes('filipino')) {
                    if (localStorage.getItem('mode') == 'Filipino') {
                        speak('language already set in Filipino mode.');
                    } else {
                        speak('setting language to filipino mode.');
                        localStorage.setItem('mode', 'Filipino'); 
                        contentMode.textContent = localStorage.getItem('mode');
                        localStorage.setItem('status', false);
                    }
                }
            };
        });


        recognition.addEventListener('end', (e) => {
           recognition.start(); 
        });

        recognition.start();
    });

    </script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
         AOS.init({
            duration: 1500,
        });
    </script>
</html>